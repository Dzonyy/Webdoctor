  [1m[35m (7.0ms)[0m  [1m[35mCREATE TABLE "inboxes" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer, "unread_messages" integer DEFAULT 0)[0m
  [1m[35m (0.1ms)[0m  [1m[34mselect sqlite_version(*)[0m
  [1m[35m (4.5ms)[0m  [1m[35mCREATE  INDEX "index_inboxes_on_user_id" ON "inboxes" ("user_id")[0m
  [1m[35m (5.9ms)[0m  [1m[35mCREATE TABLE "messages" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "body" text, "outbox_id" integer, "inbox_id" integer, "read" boolean DEFAULT 'f', "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (4.4ms)[0m  [1m[35mCREATE  INDEX "index_messages_on_inbox_id" ON "messages" ("inbox_id")[0m
  [1m[35m (0.1ms)[0m  [1m[34m            SELECT sql
            FROM sqlite_master
            WHERE name='index_messages_on_inbox_id' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_messages_on_inbox_id' AND type='index'
[0m
  [1m[35m (4.5ms)[0m  [1m[35mCREATE  INDEX "index_messages_on_outbox_id" ON "messages" ("outbox_id")[0m
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "outboxes" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer)[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE  INDEX "index_outboxes_on_user_id" ON "outboxes" ("user_id")[0m
  [1m[35m (4.4ms)[0m  [1m[35mCREATE TABLE "payments" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "user_id" integer)[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE  INDEX "index_payments_on_user_id" ON "payments" ("user_id")[0m
  [1m[35m (4.4ms)[0m  [1m[35mCREATE TABLE "users" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "is_patient" boolean DEFAULT 't', "is_doctor" boolean DEFAULT 'f', "is_admin" boolean DEFAULT 'f', "first_name" varchar, "last_name" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[35m (4.6ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT version FROM "schema_migrations"[0m
  [1m[35m (3.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20200222163628)[0m
  [1m[35m (3.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20190626153436);

[0m
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["key", "environment"], ["value", "test"], ["created_at", "2020-02-23 18:02:44.356544"], ["updated_at", "2020-02-23 18:02:44.356544"]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT  "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? LIMIT ?[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 19:02:44 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (7.8ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 1380ms (Views: 1367.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:02:20.807046"], ["updated_at", "2020-02-23 19:02:20.807046"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 1]]
  [1m[35m (9.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:02:20.819796"], ["updated_at", "2020-02-23 19:02:20.819796"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 2]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 2]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:02:20.826433"], ["updated_at", "2020-02-23 19:02:20.826433"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 3]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 3]]
  [1m[35m (5.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 2], ["inbox_id", 1], ["created_at", "2020-02-23 19:02:20.840364"], ["updated_at", "2020-02-23 19:02:20.840364"]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 1]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:03:31.617531"], ["updated_at", "2020-02-23 19:03:31.617531"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 4]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 4]]
  [1m[35m (9.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:03:31.630763"], ["updated_at", "2020-02-23 19:03:31.630763"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 5]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 5]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:03:31.637032"], ["updated_at", "2020-02-23 19:03:31.637032"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 6]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 6]]
  [1m[35m (3.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 5], ["inbox_id", 4], ["created_at", "2020-02-23 19:03:31.649812"], ["updated_at", "2020-02-23 19:03:31.649812"]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 4]]
  [1m[35m (3.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:03:31.661524"], ["updated_at", "2020-02-23 19:03:31.661524"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 7]]
  [1m[35mSQL (0.6ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 7]]
  [1m[35m (5.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:03:31.672521"], ["updated_at", "2020-02-23 19:03:31.672521"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 8]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 8]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:03:31.678719"], ["updated_at", "2020-02-23 19:03:31.678719"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 9]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 9]]
  [1m[35m (4.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 8], ["inbox_id", 7], ["created_at", "2020-02-23 19:03:31.686058"], ["updated_at", "2020-02-23 19:03:31.686058"]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 7]]
  [1m[35m (3.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1/:reply" for 127.0.0.1 at 2020-02-23 20:03:31 +0100
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:03:31 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (6.9ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 180ms (Views: 175.2ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:03:31 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:03:31.899558"], ["updated_at", "2020-02-23 19:03:31.899558"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:03:31 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (9.1ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:03:31 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.7ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 4ms (Views: 3.0ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:03:31 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:03:31.933072"], ["updated_at", "2020-02-23 19:03:31.933072"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:03:31 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (3.8ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 7ms (Views: 5.8ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:03:57.396339"], ["updated_at", "2020-02-23 19:03:57.396339"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 10]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 10]]
  [1m[35m (10.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:03:57.409555"], ["updated_at", "2020-02-23 19:03:57.409555"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 11]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 11]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:03:57.415735"], ["updated_at", "2020-02-23 19:03:57.415735"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 12]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 12]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 11], ["inbox_id", 10], ["created_at", "2020-02-23 19:03:57.428058"], ["updated_at", "2020-02-23 19:03:57.428058"]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 10]]
  [1m[35m (3.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:03:57.440668"], ["updated_at", "2020-02-23 19:03:57.440668"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 13]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 13]]
  [1m[35m (5.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:03:57.450557"], ["updated_at", "2020-02-23 19:03:57.450557"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 14]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 14]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:03:57.458854"], ["updated_at", "2020-02-23 19:03:57.458854"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 15]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 15]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 14], ["inbox_id", 13], ["created_at", "2020-02-23 19:03:57.467661"], ["updated_at", "2020-02-23 19:03:57.467661"]]
  [1m[35m (4.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 13]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1/:reply" for 127.0.0.1 at 2020-02-23 20:03:57 +0100
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:03:57 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (14.6ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 140ms (Views: 132.9ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:03:57 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:03:57.655372"], ["updated_at", "2020-02-23 19:03:57.655372"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:03:57 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (9.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 11.3ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:03:57 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.8ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 4ms (Views: 3.1ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:03:57 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:03:57.707910"], ["updated_at", "2020-02-23 19:03:57.707910"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:03:57 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (3.7ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 6ms (Views: 5.6ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:05:14.042142"], ["updated_at", "2020-02-23 19:05:14.042142"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 16]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 16]]
  [1m[35m (9.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:05:14.055155"], ["updated_at", "2020-02-23 19:05:14.055155"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 17]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 17]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:05:14.061281"], ["updated_at", "2020-02-23 19:05:14.061281"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 18]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 18]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 17], ["inbox_id", 16], ["created_at", "2020-02-23 19:05:14.073491"], ["updated_at", "2020-02-23 19:05:14.073491"]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 16]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:05:14.085285"], ["updated_at", "2020-02-23 19:05:14.085285"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 19]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 19]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:05:14.091229"], ["updated_at", "2020-02-23 19:05:14.091229"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 20]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 20]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:05:14.097414"], ["updated_at", "2020-02-23 19:05:14.097414"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 21]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 21]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 20], ["inbox_id", 19], ["created_at", "2020-02-23 19:05:14.103133"], ["updated_at", "2020-02-23 19:05:14.103133"]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 19]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/1/:reply" for 127.0.0.1 at 2020-02-23 20:05:14 +0100
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:05:14 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (6.6ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 174ms (Views: 168.8ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:05:14 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:05:14.309001"], ["updated_at", "2020-02-23 19:05:14.309001"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:05:14 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (9.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 11.3ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:05:14 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.8ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 3ms (Views: 2.9ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:05:14 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:05:14.349664"], ["updated_at", "2020-02-23 19:05:14.349664"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:05:14 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (4.0ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:05:38.900209"], ["updated_at", "2020-02-23 19:05:38.900209"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 22]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 22]]
  [1m[35m (10.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:05:38.914178"], ["updated_at", "2020-02-23 19:05:38.914178"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 23]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 23]]
  [1m[35m (5.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:05:38.921972"], ["updated_at", "2020-02-23 19:05:38.921972"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 24]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 24]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 23], ["inbox_id", 22], ["created_at", "2020-02-23 19:05:38.934360"], ["updated_at", "2020-02-23 19:05:38.934360"]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 22]]
  [1m[35m (4.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:05:38.947645"], ["updated_at", "2020-02-23 19:05:38.947645"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 25]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 25]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:05:38.953650"], ["updated_at", "2020-02-23 19:05:38.953650"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 26]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 26]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:05:38.959770"], ["updated_at", "2020-02-23 19:05:38.959770"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 27]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 27]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 26], ["inbox_id", 25], ["created_at", "2020-02-23 19:05:38.965563"], ["updated_at", "2020-02-23 19:05:38.965563"]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 25]]
  [1m[35m (2.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/1/:reply" for 127.0.0.1 at 2020-02-23 20:05:38 +0100
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:05:38 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (6.7ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 175ms (Views: 169.6ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:05:39 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:05:39.172372"], ["updated_at", "2020-02-23 19:05:39.172372"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:05:39 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (9.1ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:05:39 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (1.1ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 5ms (Views: 4.3ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:05:39 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:05:39.218403"], ["updated_at", "2020-02-23 19:05:39.218403"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 9ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:05:39 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (4.8ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 8ms (Views: 7.1ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:06:39.100463"], ["updated_at", "2020-02-23 19:06:39.100463"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 28]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 28]]
  [1m[35m (10.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:06:39.114298"], ["updated_at", "2020-02-23 19:06:39.114298"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 29]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 29]]
  [1m[35m (4.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:06:39.122025"], ["updated_at", "2020-02-23 19:06:39.122025"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 30]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 30]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 29], ["inbox_id", 28], ["created_at", "2020-02-23 19:06:39.134406"], ["updated_at", "2020-02-23 19:06:39.134406"]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 28]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:06:39.146837"], ["updated_at", "2020-02-23 19:06:39.146837"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 31]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 31]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:06:39.153257"], ["updated_at", "2020-02-23 19:06:39.153257"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 32]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 32]]
  [1m[35m (3.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:06:39.160048"], ["updated_at", "2020-02-23 19:06:39.160048"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 33]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 33]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 32], ["inbox_id", 31], ["created_at", "2020-02-23 19:06:39.165984"], ["updated_at", "2020-02-23 19:06:39.165984"]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 31]]
  [1m[35m (3.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 20:06:39 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 19:06:39.196080"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (5.5ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 179ms (Views: 164.7ms | ActiveRecord: 0.8ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:06:39 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (4.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.7ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:06:39 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:06:39.384522"], ["updated_at", "2020-02-23 19:06:39.384522"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:06:39 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (8.6ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 11ms (Views: 10.5ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:06:39 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.7ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 3ms (Views: 2.9ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:06:39 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:06:39.415207"], ["updated_at", "2020-02-23 19:06:39.415207"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 6ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:06:39 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (3.7ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.0ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:10:22.543445"], ["updated_at", "2020-02-23 19:10:22.543445"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 34]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 34]]
  [1m[35m (9.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:10:22.556567"], ["updated_at", "2020-02-23 19:10:22.556567"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 35]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 35]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:10:22.562632"], ["updated_at", "2020-02-23 19:10:22.562632"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 36]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 36]]
  [1m[35m (4.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 35], ["inbox_id", 34], ["created_at", "2020-02-23 19:10:22.575387"], ["updated_at", "2020-02-23 19:10:22.575387"]]
  [1m[35m (4.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 34]]
  [1m[35m (4.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:10:22.588672"], ["updated_at", "2020-02-23 19:10:22.588672"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 37]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 37]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:10:22.596742"], ["updated_at", "2020-02-23 19:10:22.596742"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 38]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 38]]
  [1m[35m (4.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:10:22.606333"], ["updated_at", "2020-02-23 19:10:22.606333"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 39]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 39]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.8ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 38], ["inbox_id", 37], ["created_at", "2020-02-23 19:10:22.614137"], ["updated_at", "2020-02-23 19:10:22.614137"]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 37]]
  [1m[35m (3.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:10:22.628395"], ["updated_at", "2020-02-23 19:10:22.628395"]]
  [1m[35mSQL (1.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 40]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 40]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:10:22.636509"], ["updated_at", "2020-02-23 19:10:22.636509"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 41]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 41]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:10:22.644064"], ["updated_at", "2020-02-23 19:10:22.644064"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 42]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 42]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 41], ["inbox_id", 40], ["created_at", "2020-02-23 19:10:22.652399"], ["updated_at", "2020-02-23 19:10:22.652399"]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 40]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 20:10:22 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 19:10:22.701732"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (18.4ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 138ms (Views: 115.1ms | ActiveRecord: 2.8ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:10:22 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (4.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.6ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:10:22 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:10:22.840782"], ["updated_at", "2020-02-23 19:10:22.840782"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:10:22 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (8.6ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 10.7ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:10:22 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.7ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 4ms (Views: 2.9ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:10:22 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:10:22.871647"], ["updated_at", "2020-02-23 19:10:22.871647"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 6ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:10:22 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (4.1ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.4ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:11:47.137348"], ["updated_at", "2020-02-23 19:11:47.137348"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 43]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 43]]
  [1m[35m (10.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:11:47.151594"], ["updated_at", "2020-02-23 19:11:47.151594"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 44]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 44]]
  [1m[35m (3.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:11:47.158006"], ["updated_at", "2020-02-23 19:11:47.158006"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 45]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 45]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 44], ["inbox_id", 43], ["created_at", "2020-02-23 19:11:47.170352"], ["updated_at", "2020-02-23 19:11:47.170352"]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 43]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:11:47.181146"], ["updated_at", "2020-02-23 19:11:47.181146"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 46]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 46]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:11:47.187076"], ["updated_at", "2020-02-23 19:11:47.187076"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 47]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 47]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:11:47.192773"], ["updated_at", "2020-02-23 19:11:47.192773"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 48]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 48]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 47], ["inbox_id", 46], ["created_at", "2020-02-23 19:11:47.198783"], ["updated_at", "2020-02-23 19:11:47.198783"]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 46]]
  [1m[35m (2.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:11:47.208943"], ["updated_at", "2020-02-23 19:11:47.208943"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 49]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 49]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:11:47.215244"], ["updated_at", "2020-02-23 19:11:47.215244"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 50]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 50]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:11:47.221334"], ["updated_at", "2020-02-23 19:11:47.221334"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 51]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 51]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 50], ["inbox_id", 49], ["created_at", "2020-02-23 19:11:47.227268"], ["updated_at", "2020-02-23 19:11:47.227268"]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 49]]
  [1m[35m (4.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 20:11:47 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 19:11:47.258449"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (4.9ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 175ms (Views: 160.9ms | ActiveRecord: 0.8ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:11:47 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (4.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.7ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:11:47 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:11:47.442899"], ["updated_at", "2020-02-23 19:11:47.442899"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:11:47 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.4ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (12.8ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 16ms (Views: 14.5ms | ActiveRecord: 0.7ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:11:47 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.8ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 4ms (Views: 3.1ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:11:47 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:11:47.478931"], ["updated_at", "2020-02-23 19:11:47.478931"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:11:47 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (4.6ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 8ms (Views: 6.7ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:12:13.600230"], ["updated_at", "2020-02-23 19:12:13.600230"]]
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 52]]
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 52]]
  [1m[35m (11.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:12:13.618809"], ["updated_at", "2020-02-23 19:12:13.618809"]]
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 53]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 53]]
  [1m[35m (4.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:12:13.627781"], ["updated_at", "2020-02-23 19:12:13.627781"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 54]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 54]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 53], ["inbox_id", 52], ["created_at", "2020-02-23 19:12:13.641461"], ["updated_at", "2020-02-23 19:12:13.641461"]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 52]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:12:13.652979"], ["updated_at", "2020-02-23 19:12:13.652979"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 55]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 55]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:12:13.660027"], ["updated_at", "2020-02-23 19:12:13.660027"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 56]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 56]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:12:13.666741"], ["updated_at", "2020-02-23 19:12:13.666741"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 57]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 57]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 56], ["inbox_id", 55], ["created_at", "2020-02-23 19:12:13.673783"], ["updated_at", "2020-02-23 19:12:13.673783"]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 55]]
  [1m[35m (2.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 19:12:13.684514"], ["updated_at", "2020-02-23 19:12:13.684514"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 58]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 58]]
  [1m[35m (3.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 19:12:13.691813"], ["updated_at", "2020-02-23 19:12:13.691813"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 59]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 59]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 19:12:13.698562"], ["updated_at", "2020-02-23 19:12:13.698562"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 60]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 60]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 59], ["inbox_id", 58], ["created_at", "2020-02-23 19:12:13.705139"], ["updated_at", "2020-02-23 19:12:13.705139"]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 58]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 20:12:13 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 19:12:13.737430"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (5.2ms)
  Rendered navigation/_header.html.erb (0.5ms)
Completed 200 OK in 180ms (Views: 164.7ms | ActiveRecord: 0.8ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:12:13 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (4.9ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 8ms (Views: 7.5ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:12:13 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:12:13.927650"], ["updated_at", "2020-02-23 19:12:13.927650"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:12:13 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (13.2ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 24ms (Views: 20.7ms | ActiveRecord: 0.5ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 20:12:13 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.8ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 4ms (Views: 3.1ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 20:12:13 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.5ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 19:12:13.982445"], ["updated_at", "2020-02-23 19:12:13.982445"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 11ms (ActiveRecord: 1.3ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 20:12:13 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (4.0ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 7ms (Views: 6.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:15:12.613191"], ["updated_at", "2020-02-23 20:15:12.613191"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 61]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 61]]
  [1m[35m (10.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:15:12.627194"], ["updated_at", "2020-02-23 20:15:12.627194"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 62]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 62]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:15:12.633626"], ["updated_at", "2020-02-23 20:15:12.633626"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 63]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 63]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 62], ["inbox_id", 61], ["created_at", "2020-02-23 20:15:12.646197"], ["updated_at", "2020-02-23 20:15:12.646197"]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 61]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:15:12.657733"], ["updated_at", "2020-02-23 20:15:12.657733"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 64]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 64]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:15:12.663565"], ["updated_at", "2020-02-23 20:15:12.663565"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 65]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 65]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:15:12.669576"], ["updated_at", "2020-02-23 20:15:12.669576"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 66]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 66]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 65], ["inbox_id", 64], ["created_at", "2020-02-23 20:15:12.675507"], ["updated_at", "2020-02-23 20:15:12.675507"]]
  [1m[35m (4.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 64]]
  [1m[35m (3.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 21:15:12 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 20:15:12.719218"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (12.7ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 164ms (Views: 138.1ms | ActiveRecord: 0.9ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:15:12 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (4.8ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 8ms (Views: 7.2ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:15:12 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:15:12.884144"], ["updated_at", "2020-02-23 20:15:12.884144"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:15:12 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (13.0ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 18ms (Views: 15.9ms | ActiveRecord: 0.6ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:15:12.913793"], ["updated_at", "2020-02-23 20:15:12.913793"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 67]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 67]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:15:12.917295"], ["updated_at", "2020-02-23 20:15:12.917295"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 68]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 68]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:15:12.920734"], ["updated_at", "2020-02-23 20:15:12.920734"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 69]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 69]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 68], ["inbox_id", 67], ["created_at", "2020-02-23 20:15:12.924029"], ["updated_at", "2020-02-23 20:15:12.924029"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 67]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:15:12 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.9ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 4ms (Views: 3.3ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:15:12 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:15:12.939893"], ["updated_at", "2020-02-23 20:15:12.939893"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:15:12 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (4.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 8ms (Views: 6.7ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:15:44.422130"], ["updated_at", "2020-02-23 20:15:44.422130"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 67]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 67]]
  [1m[35m (10.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:15:44.438131"], ["updated_at", "2020-02-23 20:15:44.438131"]]
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 68]]
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 68]]
  [1m[35m (4.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (1.9ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:15:44.468287"], ["updated_at", "2020-02-23 20:15:44.468287"]]
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 69]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 69]]
  [1m[35m (3.8ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 68], ["inbox_id", 67], ["created_at", "2020-02-23 20:15:44.484292"], ["updated_at", "2020-02-23 20:15:44.484292"]]
  [1m[35m (3.4ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 67]]
  [1m[35m (3.1ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:15:44.495731"], ["updated_at", "2020-02-23 20:15:44.495731"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 70]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 70]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:15:44.502769"], ["updated_at", "2020-02-23 20:15:44.502769"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 71]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 71]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:15:44.509752"], ["updated_at", "2020-02-23 20:15:44.509752"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 72]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 72]]
  [1m[35m (4.9ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 71], ["inbox_id", 70], ["created_at", "2020-02-23 20:15:44.517995"], ["updated_at", "2020-02-23 20:15:44.517995"]]
  [1m[35m (3.3ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 70]]
  [1m[35m (3.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 21:15:44 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 20:15:44.552191"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (5.5ms)
  Rendered navigation/_header.html.erb (0.5ms)
Completed 200 OK in 194ms (Views: 177.5ms | ActiveRecord: 0.9ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:15:44 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (4.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.8ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:15:44 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:15:44.755645"], ["updated_at", "2020-02-23 20:15:44.755645"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 8ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:15:44 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (11.5ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 17ms (Views: 14.5ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:15:44.783812"], ["updated_at", "2020-02-23 20:15:44.783812"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 73]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 73]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:15:44.786380"], ["updated_at", "2020-02-23 20:15:44.786380"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 74]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 74]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:15:44.788544"], ["updated_at", "2020-02-23 20:15:44.788544"]]
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 75]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 75]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:16:25.718856"], ["updated_at", "2020-02-23 20:16:25.718856"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 73]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 73]]
  [1m[35m (10.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:16:25.732307"], ["updated_at", "2020-02-23 20:16:25.732307"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 74]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 74]]
  [1m[35m (3.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:16:25.738801"], ["updated_at", "2020-02-23 20:16:25.738801"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 75]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 75]]
  [1m[35m (3.7ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 74], ["inbox_id", 73], ["created_at", "2020-02-23 20:16:25.751699"], ["updated_at", "2020-02-23 20:16:25.751699"]]
  [1m[35m (5.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 73]]
  [1m[35m (5.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:16:25 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (6.7ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 170ms (Views: 164.6ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:16:25 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:16:25.960837"], ["updated_at", "2020-02-23 20:16:25.960837"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:16:25 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (9.1ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:17:09.053940"], ["updated_at", "2020-02-23 20:17:09.053940"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 76]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 76]]
  [1m[35m (10.2ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:17:09.067479"], ["updated_at", "2020-02-23 20:17:09.067479"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 77]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 77]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:17:09.074229"], ["updated_at", "2020-02-23 20:17:09.074229"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 78]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 78]]
  [1m[35m (5.0ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 77], ["inbox_id", 76], ["created_at", "2020-02-23 20:17:09.087883"], ["updated_at", "2020-02-23 20:17:09.087883"]]
  [1m[35m (5.6ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 76]]
  [1m[35m (3.5ms)[0m  [1m[36mcommit transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:17:09 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (6.8ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 181ms (Views: 176.0ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:17:09 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:17:09.302835"], ["updated_at", "2020-02-23 20:17:09.302835"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 10ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:17:09 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (9.1ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 11.0ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?)[0m  [["first_name", "Luke"], ["last_name", "Skywalker"], ["created_at", "2020-02-23 20:18:02.577590"], ["updated_at", "2020-02-23 20:18:02.577590"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 79]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 79]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:18:02.580962"], ["updated_at", "2020-02-23 20:18:02.580962"]]
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 80]]
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 80]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:18:02.583182"], ["updated_at", "2020-02-23 20:18:02.583182"]]
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 81]]
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 81]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 80], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 79], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Thanks for your order. I will in touch shortly after reviewing your treatment application."], ["outbox_id", 80], ["inbox_id", 79], ["created_at", "2020-02-23 20:18:02.593258"], ["updated_at", "2020-02-23 20:18:02.593258"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 79], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 79]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:18:02 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (7.7ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 181ms (Views: 173.1ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:18:02 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:18:02.805163"], ["updated_at", "2020-02-23 20:18:02.805163"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:18:02 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (9.1ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 11.1ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.0ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_doctor", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_doctor", "t"], ["first_name", "Leia"], ["last_name", "Organa"], ["created_at", "2020-02-23 20:24:23.131228"], ["updated_at", "2020-02-23 20:24:23.131228"]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 79]]
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 79]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  [1m[32mINSERT INTO "users" ("is_patient", "is_admin", "first_name", "last_name", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["is_patient", "f"], ["is_admin", "t"], ["first_name", "Obi-wan"], ["last_name", "Kenobi"], ["created_at", "2020-02-23 20:24:23.134339"], ["updated_at", "2020-02-23 20:24:23.134339"]]
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "inboxes" ("user_id") VALUES (?)[0m  [["user_id", 80]]
  [1m[35mSQL (0.0ms)[0m  [1m[32mINSERT INTO "outboxes" ("user_id") VALUES (?)[0m  [["user_id", 80]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", nil], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:24:52 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (7.2ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 194ms (Views: 181.3ms | ActiveRecord: 0.3ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:24:52 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:24:52.844864"], ["updated_at", "2020-02-23 20:24:52.844864"]]
  [1m[35m (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 39ms (ActiveRecord: 3.1ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:24:52 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (10.8ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 14ms (Views: 12.7ms | ActiveRecord: 0.5ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:28:14 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (18.3ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 193ms (Views: 180.5ms | ActiveRecord: 0.4ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:28:14 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:28:14.937562"], ["updated_at", "2020-02-23 20:28:14.937562"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 1.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:28:14 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (10.1ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 13ms (Views: 11.9ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:28:54 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (18.5ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 191ms (Views: 178.0ms | ActiveRecord: 0.5ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:28:54 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:28:54.815447"], ["updated_at", "2020-02-23 20:28:54.815447"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 1.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:28:54 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (11.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 17ms (Views: 14.4ms | ActiveRecord: 0.5ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:29:17 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (18.9ms)
  Rendered navigation/_header.html.erb (1.4ms)
Completed 200 OK in 226ms (Views: 213.8ms | ActiveRecord: 0.3ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:29:18 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.3ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.6ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:29:18.158956"], ["updated_at", "2020-02-23 20:29:18.158956"]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (1.3ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 125ms (ActiveRecord: 7.9ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:29:18 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.2ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.2ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (40.4ms)
  Rendered navigation/_header.html.erb (2.7ms)
Completed 200 OK in 54ms (Views: 48.3ms | ActiveRecord: 1.5ms)
  [1m[36mMessage Load (0.6ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:31:50 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (6.8ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 178ms (Views: 155.4ms | ActiveRecord: 1.5ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:31:50 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:31:50.746803"], ["updated_at", "2020-02-23 20:31:50.746803"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 1.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:31:50 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (10.2ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 13ms (Views: 12.1ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:33:16 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (7.0ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 185ms (Views: 173.0ms | ActiveRecord: 0.3ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:33:17 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:33:17.214330"], ["updated_at", "2020-02-23 20:33:17.214330"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 1.7ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:33:17 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (10.7ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 14ms (Views: 12.7ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:33:38 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (18.4ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 192ms (Views: 179.0ms | ActiveRecord: 0.4ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:33:38 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:33:38.864047"], ["updated_at", "2020-02-23 20:33:38.864047"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 32ms (ActiveRecord: 1.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:33:38 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (10.1ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 13ms (Views: 11.9ms | ActiveRecord: 0.4ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 21:38:34 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.7ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 20:38:34.919481"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (13.9ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 210ms (Views: 139.7ms | ActiveRecord: 2.7ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:38:35 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (4.4ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.6ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:38:35 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:38:35.084246"], ["updated_at", "2020-02-23 20:38:35.084246"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 7ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:38:35 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.2ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (9.0ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 12ms (Views: 10.9ms | ActiveRecord: 0.5ms)
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" ORDER BY "messages"."id" DESC LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m
Started GET "/message/new/1" for 127.0.0.1 at 2020-02-23 21:38:35 +0100
Processing by MessagesController#new as HTML
  Parameters: {"reply"=>"1"}
  Rendering messages/new.html.erb within layouts/application
  Rendered messages/new.html.erb within layouts/application (0.7ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 3ms (Views: 2.9ms | ActiveRecord: 0.0ms)
Started POST "/message/new/1" for 127.0.0.1 at 2020-02-23 21:38:35 +0100
Processing by MessagesController#create as HTML
  Parameters: {"utf8"=>"✓", "message"=>{"body"=>"Test msg"}, "commit"=>"Send Message", "reply"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = 1 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_doctor" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_doctor", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 2 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "Test msg"], ["outbox_id", 1], ["inbox_id", 2], ["created_at", "2020-02-23 20:38:35.115566"], ["updated_at", "2020-02-23 20:38:35.115566"]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 2]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 6ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:38:35 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.0ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.0ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (3.9ms)
  Rendered navigation/_header.html.erb (0.3ms)
Completed 200 OK in 7ms (Views: 6.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 21:39:16 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.1ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.1ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.0ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 20:39:16.716849"], ["id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (14.6ms)
  Rendered navigation/_header.html.erb (0.4ms)
Completed 200 OK in 206ms (Views: 148.2ms | ActiveRecord: 2.0ms)
  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.5ms)[0m  [1m[36mbegin transaction[0m
Started GET "/messages/1" for 127.0.0.1 at 2020-02-23 21:41:36 +0100
Processing by MessagesController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36mMessage Load (0.4ms)[0m  [1m[34mSELECT  "messages".* FROM "messages" WHERE "messages"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mOutbox Load (0.7ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mInbox Load (0.3ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35mSQL (1.3ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", -1], ["id", 2]]
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mInbox Load (0.1ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "messages" SET "read" = ?, "updated_at" = ? WHERE "messages"."id" = ?[0m  [["read", "t"], ["updated_at", "2020-02-23 20:41:36.410903"], ["id", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  Rendering messages/show.html.erb within layouts/application
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  Rendered messages/show.html.erb within layouts/application (31.3ms)
  Rendered navigation/_header.html.erb (0.6ms)
Completed 200 OK in 911ms (Views: 661.8ms | ActiveRecord: 10.9ms)
Started POST "/payments/new/1" for 127.0.0.1 at 2020-02-23 21:41:37 +0100
Processing by PaymentsController#create as HTML
  Parameters: {"user_id"=>"1"}
  [1m[36mOutbox Load (1.5ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_admin" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_admin", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.7ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = 3 LIMIT ?[0m  [["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "messages" ("body", "outbox_id", "inbox_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["body", "I've lost my script, please issue a new one at a charge of €10"], ["outbox_id", 1], ["inbox_id", 3], ["created_at", "2020-02-23 20:41:37.136629"], ["updated_at", "2020-02-23 20:41:37.136629"]]
  [1m[35m (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35mSQL (0.1ms)[0m  [1m[33mUPDATE "inboxes" SET "unread_messages" = ? WHERE "inboxes"."id" = ?[0m  [["unread_messages", 1], ["id", 3]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35mSQL (0.2ms)[0m  [1m[32mINSERT INTO "payments" ("user_id") VALUES (?)[0m  [["user_id", 1]]
  [1m[35m (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/
Completed 302 Found in 40ms (ActiveRecord: 5.6ms)
Started GET "/" for 127.0.0.1 at 2020-02-23 21:41:37 +0100
Processing by MessagesController#index as HTML
  Rendering messages/index.html.erb within layouts/application
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."is_patient" = ? ORDER BY "users"."id" ASC LIMIT ?[0m  [["is_patient", "t"], ["LIMIT", 1]]
  [1m[36mInbox Load (0.2ms)[0m  [1m[34mSELECT  "inboxes".* FROM "inboxes" WHERE "inboxes"."user_id" = ? LIMIT ?[0m  [["user_id", 1], ["LIMIT", 1]]
  [1m[36mMessage Load (0.8ms)[0m  [1m[34mSELECT "messages".* FROM "messages" WHERE "messages"."inbox_id" = ?[0m  [["inbox_id", 1]]
  [1m[36mOutbox Load (0.5ms)[0m  [1m[34mSELECT  "outboxes".* FROM "outboxes" WHERE "outboxes"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  Rendered messages/index.html.erb within layouts/application (49.2ms)
  Rendered navigation/_header.html.erb (2.6ms)
Completed 200 OK in 64ms (Views: 60.5ms | ActiveRecord: 2.3ms)
  [1m[35m (0.5ms)[0m  [1m[31mrollback transaction[0m
